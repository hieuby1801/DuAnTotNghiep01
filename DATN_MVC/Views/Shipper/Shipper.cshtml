@model List<DATN_MVC.DTOs.VanChuyenDTO>
@{
	Layout = null;
	var nguoiDungId = Context.Session.GetString("NguoiDungId");
	var Tengnuoidung = Context.Session.GetString("Ten");
}
<!DOCTYPE html>
<html lang="vi">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Shipper Giao Hàng</title>
	<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Quicksand', sans-serif;
			background: #f5f5f5;
			margin: 0;
			padding: 0;
			color: #333;
		}

		/* HEADER */
		.header {
			background-color: #2196f3;
			color: white;
			padding: 25px 40px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			border-bottom: 5px solid #1976d2;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
		}

			.header h1 {
				font-size: 32px;
				margin: 0;
				font-weight: 600;
				letter-spacing: 2px;
			}

		.username-display {
			font-size: 18px;
			font-weight: 500;
			color: #ffeb3b;
			text-align: right;
		}

		.order-status {
			display: flex;
			gap: 30px;
			justify-content: center;
		}

			.order-status div {
				font-size: 18px;
				font-weight: 600;
				text-align: center;
			}

				.order-status div span {
					color: #388e3c;
					font-size: 22px;
				}

		/* DASHBOARD */
		.dashboard {
			max-width: 1100px;
			margin: 50px auto;
			padding: 40px;
			display: grid;
			gap: 30px;
			grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
		}

		.order-card {
			background: #ffffff;
			padding: 20px;
			border-radius: 15px;
			box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
			display: flex;
			gap: 20px;
			flex-direction: column;
			transition: transform 0.3s ease, box-shadow 0.3s ease;
		}

			.order-card:hover {
				transform: translateY(-5px);
				box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
			}

			.order-card img {
				width: 100%;
				height: 180px;
				object-fit: cover;
				border-radius: 10px;
			}

			.order-card p {
				font-size: 16px;
				color: #555;
				margin: 5px 0;
			}

				.order-card p strong {
					color: #2196f3;
				}

		/* BUTTONS */
		.buttons {
			display: flex;
			gap: 15px;
			justify-content: flex-start;
		}

		.btn-lay, .btn-giao {
			padding: 12px 25px;
			border: none;
			border-radius: 8px;
			color: white;
			font-weight: 600;
			cursor: pointer;
			transition: background-color 0.3s, transform 0.3s;
		}

		.btn-lay {
			background-color: #03a9f4;
		}

		.btn-giao {
			background-color: #43a047;
		}

		.btn-lay:hover {
			background-color: #0288d1;
			transform: scale(1.05);
		}

		.btn-giao:hover {
			background-color: #388e3c;
			transform: scale(1.05);
		}

		.btn-filter {
			background-color: #e3f2fd;
			border: 1px solid #2196f3;
			padding: 10px 20px;
			border-radius: 8px;
			color: #0d47a1;
			font-weight: 600;
			cursor: pointer;
			transition: 0.2s;
		}

			.btn-filter:hover {
				background-color: #bbdefb;
			}

	</style>
</head>
<body>

	<!-- HEADER -->
	<div class="header">
		<h1>Giao hàng</h1>
		<div class="order-status">
			<form method="post" asp-action="LocTheoTrangThai">
				<button type="submit" name="trangthai" value="Đang chờ nhận hàng" class="btn-filter">
					Chờ nhận: @Model.Count(x => x.TrangThai == "Đang chờ nhận hàng")
				</button>
				<button type="submit" name="trangthai" value="@($"{Tengnuoidung} Đã nhận giao")" class="btn-filter">
					Đang giao: @Model.Count(x => x.TrangThai == $"{Tengnuoidung} Đã nhận giao")
				</button>
				<button type="submit" name="trangthai" value="Giao thành công" class="btn-filter">
					Đã giao: @Model.Count(x => x.TrangThai == "Giao thành công")
				</button>
			</form>
		</div>
		<div class="username-display" id="displayUsername">Chào shipper: @Tengnuoidung</div>
	</div>

	<!-- GIAO DIỆN SHIPPER -->
	<div class="dashboard">
		<div class="order-card">
			@foreach (var item in Model)
			{
				<div>
					<form asp-action="Chuyentrangthai" method="post">

						<p><strong>Mã vận chuyển:</strong> @item.MaVanChuyen</p>

						@foreach (var item1 in item.SanPhams)
						{
							<p><strong>Sản phẩm:</strong> @item1.TenSach</p>
							<img src="@Url.Content(item1.HinhAnh)" alt="Sản phẩm">
						}

						<p><strong>Địa chỉ:</strong> @item.DiaChi</p>
						<p><strong>SĐT:</strong> @item.SDT</p>
						<p><strong>Tổng tiền:</strong> @item.TongTien</p>

						<div class="buttons">
							<input type="hidden" name="mavanchuyen" value="@item.MaVanChuyen" />
							<input type="hidden" name="madonhang" value="@item.MaDonHang" />
							<input type="hidden" name="nguoiDungId" value="@nguoiDungId" />
							<input type="hidden" name="ten" value="@Tengnuoidung" />

							@if (item.TrangThai == "Đang chờ nhận hàng")
							{
								<button type="submit" name="action" class="btn-lay" value="NhanHang"> Nhận hàng</button>
							}

							@if (item.TrangThai != "Giao thành công" && item.TrangThai != "Đang chờ nhận hàng")
							{
								<button type="submit" name="action"  class="btn-giao" value="GiaoHangThanhCong">Giao hàng thành công</button>
							}

						</div>
					</form>
				</div>
			}
		</div>
	</div>
</body>
</html>
